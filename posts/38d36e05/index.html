<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Pandas | Dasi's Blog</title><meta name="author" content="Dasi"><meta name="copyright" content="Dasi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Pandas 简介、Series、DataFrame、CSV、JSON、数据清洗、数据预处理、数值分析、时间序列分析、性能优化"><meta property="og:type" content="article"><meta property="og:title" content="Pandas"><meta property="og:url" content="https://dasi.plus/posts/38d36e05/"><meta property="og:site_name" content="Dasi&#39;s Blog"><meta property="og:description" content="Pandas 简介、Series、DataFrame、CSV、JSON、数据清洗、数据预处理、数值分析、时间序列分析、性能优化"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://dasi.plus/image/analysis.png"><meta property="article:published_time" content="2025-04-06T08:15:40.000Z"><meta property="article:modified_time" content="2025-06-23T11:55:01.774Z"><meta property="article:author" content="Dasi"><meta property="article:tag" content="Data Analysis"><meta property="article:tag" content="Python"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://dasi.plus/image/analysis.png"><link rel="shortcut icon" href="/image/avatar.webp"><link rel="canonical" href="https://dasi.plus/posts/38d36e05/"><link rel="preconnect"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css?v=6.5.1"><link rel="stylesheet" href="/pluginsSrc/@fancyapps/ui/dist/fancybox/fancybox.css?v=5.0.33" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!0,top_n_per_article:8,unescape:!1,languages:{hits_empty:"找不到您查询的内容：${query}",hits_stats:"共找到 ${hits} 篇文章"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:300},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:250,languages:{author:"作者: Dasi",link:"链接: ",source:"来源: Dasi's Blog",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:void 0,infinitegrid:{js:"/pluginsSrc/@egjs/infinitegrid/dist/infinitegrid.min.js?v=4.11.1",buttonText:"加载更多"},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,percent:{toc:!1,rightside:!1},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Pandas",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2025-06-23 19:55:01"}</script><link rel="stylesheet" href="APlayer.min.css"><div id="aplayer"></div><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js" async></script><script>(e=>{e.saveToLocal={set:(e,t,o)=>{if(0===o)return;const a={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(a))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise(((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},Object.keys(t).forEach((e=>{n.setAttribute(e,t[e])})),document.head.appendChild(n)})),e.getCSS=(e,t=!1)=>new Promise(((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},document.head.appendChild(n)})),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/tag.css?1"><link rel="stylesheet" href="/css/nav.css?1"><link rel="stylesheet" href="/css/homeArticle.css?1"><link rel="stylesheet" href="/css/category.css?1"><link rel="stylesheet" href="/css/cursor.css?1"><link rel="stylesheet" href="/css/background.css?1"><link rel="stylesheet" href="/css/rightmenu.css?1"><link rel="stylesheet" href="/css/copyright.css?1"><link rel="stylesheet" href="/css/archive.css?1"><link rel="stylesheet" href="/css/description.css?1"><link rel="stylesheet" href="/css/post.css?1"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload='this.media="all"'><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{const d=document.getElementById("loading-box"),e=document.body,o=()=>{e.style.overflow="",d.classList.add("loaded")},l=()=>{e.style.overflow="hidden",d.classList.remove("loaded")};l(),window.addEventListener("load",(()=>{o()}))})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/avatar.webp" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">90</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">23</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i> <span>博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-star"></i> <span>生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/travel/"><i class="fa-fw fas fa-globe"></i> <span>旅游</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('/image/analysis.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Dasi's Blog"><img class="site-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/avatar.webp"><span class="site-name">Dasi's Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i> <span>博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-star"></i> <span>生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/travel/"><i class="fa-fw fas fa-globe"></i> <span>旅游</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Pandas</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2025-04-06T08:15:40.000Z" title="发表于 2025-04-06 16:15:40">2025-04-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">10k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>43分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Pandas"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><meta name="referrer" content="no-referrer"><h2 id="0-前言">0. 前言</h2><p>在 python 中引用 numpy 库格式为 <code>import pandas as pd</code>，所以本笔记都用 <code>pd</code> 代替 <code>pandas</code>，同时省略了引入库语句</p><h2 id="1-Pandas-简介">1. Pandas 简介</h2><p>Pandas 一开始我以为是和熊猫有联系，或者像 Python 那样以蟒蛇命名，现在才知道原来 Pandas 指的是 “Python Data Analysis” 即 Python 数据分析。</p><p>为什么 Pandas 能够直接命名为 Python 数据分析，而不是像 NumPy 一样用 Python 数组命名，这取决于其强大的数据功能：</p><ul><li><strong>数据清洗</strong>：处理缺失数据、重复数据等</li><li><strong>数据操作</strong>：支持高效的数据选择、筛选、切片，按条件提取数据、合并、连接多个数据集、数据分组、汇总统计等操作，可以进行复杂的数据变换</li><li><strong>数据分析</strong>：进行统计分析、聚合、分组等</li><li><strong>数据可视化</strong>：通过整合 Matplotlib 和 Seaborn 等库，可以进行数据可视化</li><li><strong>数据文件</strong>：可以轻松读写 CSV、Excel、JSON 等多种文件格式</li><li><strong>数据缺失</strong>：用 <code>pd.NA</code> 和 “NaN（Not a Number）” 表示缺失数据，而不是 None 、跳过或者报错</li></ul><h2 id="2-Series">2. Series</h2><h3 id="2-1-创建">2.1 创建</h3><p>Series 是 Pandas 的一个核心数据结构，类似于一个一维的数组，可以存储任何数据类型（整型、浮点型、字符型、对象等），并通过索引来访问元素。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.Series(data=, index=, dtype=, name=)</span><br></pre></td></tr></table></figure><ul><li>data：可以是列表、数组、字典等</li><li>index：按照 data 顺序指定索引值，如果不提供会自动创建一个默认的 <code>range(n)</code> 作为索引，其中 n 是 data 的长度</li><li>dtype：指定数据类型，如果不提供此参数，则根据数据自动推断数据类型</li><li>name：Series 的名称，注意不是变量名，而是一个属性值</li></ul><p>Series 与 list 和 numpy 最大的不同之处就在于，<strong>它可以给对象命名，还可以自定义索引值，以及不同索引的数据类型可以不一样</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">&#x27;Dasi&#x27;</span></span><br><span class="line">indices = [<span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;school&#x27;</span>, <span class="string">&#x27;major&#x27;</span>]</span><br><span class="line">values = [<span class="number">21</span>, <span class="string">&#x27;sysu&#x27;</span>, <span class="string">&#x27;cs&#x27;</span>]</span><br><span class="line">my_series = pd.Series(values, index=indices, name=name)</span><br><span class="line"><span class="built_in">print</span>(my_series)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605279.png" alt=""></p><blockquote><p>虽然技术上可以将 Series 的数据类型设置为 object 来存放不同类型的数据，但推荐在数据分析中尽量保持 Series 的数据类型一致，以便利用 Pandas 和 NumPy 的高效运算</p></blockquote><p>可以发现一个索引对应一个值，所以可以用字典的键值对进行初始化，并且还能利用索引访问值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">&#x27;Dasi&#x27;</span></span><br><span class="line">my_dict = &#123;<span class="string">&#x27;age&#x27;</span>: <span class="number">21</span>, <span class="string">&#x27;school&#x27;</span>: <span class="string">&#x27;sysu&#x27;</span>, <span class="string">&#x27;major&#x27;</span>: <span class="string">&#x27;cs&#x27;</span>&#125;</span><br><span class="line">my_series = pd.Series(my_dict, name=name)</span><br><span class="line"><span class="built_in">print</span>(my_series[<span class="string">&quot;school&quot;</span>], my_series[<span class="string">&quot;age&quot;</span>])</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605238.png" alt=""></p><h3 id="2-2-属性">2.2 属性</h3><table><thead><tr><th>属性</th><th>功能</th></tr></thead><tbody><tr><td>index</td><td>获取索引</td></tr><tr><td>values</td><td>获取数据，以 NumPy 形式返回</td></tr><tr><td>size</td><td>获取元素个数，即行数</td></tr><tr><td>name</td><td>获取名称</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">student = <span class="string">&#x27;Dasi&#x27;</span></span><br><span class="line">exams = [<span class="string">&#x27;OS&#x27;</span>, <span class="string">&#x27;DB&#x27;</span>, <span class="string">&#x27;AI&#x27;</span>]</span><br><span class="line">scores = [<span class="number">95</span>, <span class="number">92</span>, <span class="number">93</span>]</span><br><span class="line">my_series = pd.Series(scores, index=exams, name=student)</span><br><span class="line"><span class="built_in">print</span>(my_series.index)</span><br><span class="line"><span class="built_in">print</span>(my_series.values)</span><br><span class="line"><span class="built_in">print</span>(my_series.size)</span><br><span class="line"><span class="built_in">print</span>(my_series.name)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605240.png" alt=""></p><h3 id="2-3-有关索引的方法">2.3 有关索引的方法</h3><table><thead><tr><th>方法</th><th>功能</th></tr></thead><tbody><tr><td>head(n)</td><td>获取前 n 行</td></tr><tr><td>tail(n)</td><td>获取后 n 行</td></tr><tr><td>iloc[]</td><td>通过位置索引来选择数据</td></tr><tr><td>loc[]</td><td>通过标签索引来选择数据</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">student = <span class="string">&#x27;Dasi&#x27;</span></span><br><span class="line">exams = [<span class="string">&#x27;OS&#x27;</span>, <span class="string">&#x27;DB&#x27;</span>, <span class="string">&#x27;AI&#x27;</span>]</span><br><span class="line">scores = [<span class="number">95</span>, <span class="number">92</span>, <span class="number">93</span>]</span><br><span class="line">my_series = pd.Series(scores, index=exams, name=student)</span><br><span class="line"><span class="built_in">print</span>(my_series.head(<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(my_series.tail(<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(my_series.iloc[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(my_series.loc[<span class="string">&#x27;DB&#x27;</span>])</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605241.png" alt=""></p><h3 id="2-3-有关元素的方法">2.3 有关元素的方法</h3><table><thead><tr><th>方法</th><th>功能</th></tr></thead><tbody><tr><td>astype(dtype)</td><td>将元素转换为指定类型</td></tr><tr><td>replace(to_replace, value)</td><td>将元素转换为指定值</td></tr><tr><td>apply(func) 或 map(func)</td><td>将指定函数应用于每个元素</td></tr><tr><td>shift(periods)</td><td>将元素向上（负数）或向下（正数）平移，超出会丢弃，空出会补 NaN</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">discount</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x * <span class="number">0.95</span></span><br><span class="line"></span><br><span class="line">student = <span class="string">&#x27;Dasi&#x27;</span></span><br><span class="line">exams = [<span class="string">&#x27;OS&#x27;</span>, <span class="string">&#x27;DB&#x27;</span>, <span class="string">&#x27;AI&#x27;</span>]</span><br><span class="line">scores = [<span class="number">95</span>, <span class="number">92</span>, <span class="number">93</span>]</span><br><span class="line">my_series = pd.Series(scores, index=exams, name=student)</span><br><span class="line">my_series = my_series.astype(<span class="string">&#x27;float16&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(my_series)</span><br><span class="line"><span class="built_in">print</span>(my_series.replace(<span class="number">95.0</span>, <span class="number">100.0</span>))</span><br><span class="line"><span class="built_in">print</span>(my_series.<span class="built_in">map</span>(discount))</span><br><span class="line"><span class="built_in">print</span>(my_series.shift(<span class="number">1</span>))</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605242.png" alt=""></p><h3 id="2-4-有关-NaN-的方法">2.4 有关 NaN 的方法</h3><table><thead><tr><th>方法</th><th>功能</th></tr></thead><tbody><tr><td>dropna()</td><td>删除 NaN 值对应的行</td></tr><tr><td>fillna(value)</td><td></td></tr><tr><td>isna()</td><td>返回一个布尔 Series 表示每个索引对应的值是否为 NaN</td></tr><tr><td>notna()</td><td>返回一个布尔 Series 表示每个索引对应的值是否为 NaN</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">student = <span class="string">&#x27;Dasi&#x27;</span></span><br><span class="line">exams = [<span class="string">&#x27;OS&#x27;</span>, <span class="string">&#x27;DB&#x27;</span>, <span class="string">&#x27;AI&#x27;</span>]</span><br><span class="line">scores = [<span class="number">95</span>, <span class="number">92</span>, pd.NA]</span><br><span class="line">my_series = pd.Series(scores, index=exams, name=student)</span><br><span class="line"><span class="built_in">print</span>(my_series.dropna())</span><br><span class="line"><span class="built_in">print</span>(my_series.fillna(<span class="number">100</span>))</span><br><span class="line"><span class="built_in">print</span>(my_series.isna())</span><br><span class="line"><span class="built_in">print</span>(my_series.notna())</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605243.png" alt=""></p><h3 id="2-5-有关统计的方法">2.5 有关统计的方法</h3><table><thead><tr><th>方法</th><th>功能</th></tr></thead><tbody><tr><td>unique()</td><td>去重，返回唯一值组成的 Series</td></tr><tr><td>value_counts()</td><td>返回每个唯一值个数组成的 Series</td></tr><tr><td>sort_values()</td><td>对值进行排序</td></tr><tr><td>sort_index()</td><td>对索引进行排序</td></tr><tr><td>rank()</td><td>返回元素按值的排名，如果多个元素值相同，则会按照平均排名分配相同的排名值</td></tr><tr><td>describe()</td><td>获取统计描述</td></tr><tr><td>corr(series)</td><td>返回与另一个 Series 的皮尔逊相关系数</td></tr><tr><td>cov(series)</td><td>返回与另一个 Series 的协方差</td></tr><tr><td>diff(periods)</td><td>计算当前值与前一个值之间的差值</td></tr><tr><td>cunsum()</td><td>返回累计和</td></tr><tr><td>cumprod()</td><td>返回累计乘积</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">student = <span class="string">&#x27;Dasi&#x27;</span></span><br><span class="line">exams = [<span class="string">&#x27;OS&#x27;</span>, <span class="string">&#x27;DB&#x27;</span>, <span class="string">&#x27;AI&#x27;</span>]</span><br><span class="line">scores = [<span class="number">92</span>, <span class="number">92</span>, <span class="number">95</span>]</span><br><span class="line">my_series = pd.Series(scores, index=exams, name=student)</span><br><span class="line"><span class="built_in">print</span>(my_series.value_counts())</span><br><span class="line"><span class="built_in">print</span>(my_series.rank())</span><br><span class="line"><span class="built_in">print</span>(my_series.sort_index())</span><br><span class="line"><span class="built_in">print</span>(my_series.sort_values())</span><br><span class="line"><span class="built_in">print</span>(my_series.diff(<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(my_series.cumsum())</span><br><span class="line"><span class="built_in">print</span>(my_series.describe())</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605244.png" alt=""></p><h3 id="2-6-布尔索引-条件过滤">2.6 布尔索引/条件过滤</h3><p>可以利用条件表达式获得布尔索引，然后利用布尔索引进行条件过滤得到满足条件的 Series</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">student = <span class="string">&#x27;Dasi&#x27;</span></span><br><span class="line">exams = [<span class="string">&#x27;OS&#x27;</span>, <span class="string">&#x27;DB&#x27;</span>, <span class="string">&#x27;AI&#x27;</span>]</span><br><span class="line">scores = [<span class="number">92</span>, <span class="number">92</span>, <span class="number">95</span>]</span><br><span class="line">my_series = pd.Series(scores, index=exams, name=student)</span><br><span class="line"><span class="built_in">print</span>(my_series &gt; <span class="number">92</span>)</span><br><span class="line"><span class="built_in">print</span>(my_series[my_series &gt; <span class="number">92</span>])</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605245.png" alt=""></p><h2 id="3-DataFrame">3. DataFrame</h2><blockquote><p>Series 的大部分属性和方法都同样适用于 DataFrame</p></blockquote><h3 id="3-1-创建">3.1 创建</h3><p>DataFrame 是 Pandas 中的另一个核心数据结构，类似于一个<strong>二维的表格或数据库中的数据表</strong>，它含有一组有序的列，每列可以是不同的数据类型。</p><p>DataFrame 既有行索引也有列索引，它可以被看做由 Series 组成的字典，Series 的名称作为列索引，值之间共用一个行索引</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.DataFrame(data=, index=, columns=)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605246.png" alt=""></p><p>创建一个 DataFrame 有多种方式，可以用二维列表/数组、列表字典</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">indices = [<span class="string">&#x27;Dasi&#x27;</span>, <span class="string">&#x27;Jason&#x27;</span>, <span class="string">&#x27;wyw&#x27;</span>]</span><br><span class="line">my_list = [[<span class="string">&#x27;SYSU&#x27;</span>, <span class="number">21</span>], [<span class="string">&#x27;THFLS&#x27;</span>, <span class="number">20</span>], [<span class="string">&#x27;JJXX&#x27;</span>, <span class="number">18</span>]]</span><br><span class="line">col_index = [<span class="string">&#x27;School&#x27;</span>, <span class="string">&#x27;Age&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(pd.DataFrame(my_list, index=indices, columns=col_index))</span><br><span class="line">my_dict = &#123;<span class="string">&#x27;School&#x27;</span>: [<span class="string">&#x27;SYSU&#x27;</span>,<span class="string">&#x27;THFLS&#x27;</span>,<span class="string">&#x27;JJXX&#x27;</span>], <span class="string">&#x27;Age&#x27;</span>: [<span class="number">95</span>,<span class="number">92</span>,<span class="number">93</span>]&#125;</span><br><span class="line"><span class="built_in">print</span>(pd.DataFrame(my_dict, index=indices))</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605247.png" alt=""></p><p>实际上每一行每一列都可以视为一个 Series：如果是某一行，Series 的名称就是当前行索引的标签，Series 的索引值就是列索引的值；如果是某一列，Series 的名称就是当前列的标签，Series 的索引值就是行索引的值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">indices = [<span class="string">&#x27;Dasi&#x27;</span>, <span class="string">&#x27;Jason&#x27;</span>, <span class="string">&#x27;wyw&#x27;</span>]</span><br><span class="line">my_dict = &#123;<span class="string">&#x27;School&#x27;</span>: [<span class="string">&#x27;SYSU&#x27;</span>,<span class="string">&#x27;THFLS&#x27;</span>,<span class="string">&#x27;JJXX&#x27;</span>], <span class="string">&#x27;Age&#x27;</span>: [<span class="number">20</span> ,<span class="number">21</span>, <span class="number">18</span>]&#125;</span><br><span class="line">df = pd.DataFrame(my_dict, index=indices)</span><br><span class="line"><span class="built_in">print</span>(df.loc[<span class="string">&#x27;Dasi&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df[<span class="string">&#x27;School&#x27;</span>])</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605248.png" alt=""></p><blockquote><p>直接使用索引值获取列而不是行</p></blockquote><h3 id="3-2-属性">3.2 属性</h3><p>这里主要列举相比于 Series 多出来的属性</p><table><thead><tr><th>属性</th><th>功能</th></tr></thead><tbody><tr><td>shape</td><td>返回元组 (行数, 列数)</td></tr><tr><td>columns</td><td>返回所有列标签</td></tr><tr><td>index</td><td>返回所有行标签</td></tr><tr><td>dtypes</td><td>返回每一列的数据类型</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">indices = [<span class="string">&#x27;Dasi&#x27;</span>, <span class="string">&#x27;Jason&#x27;</span>, <span class="string">&#x27;wyw&#x27;</span>]</span><br><span class="line">my_dict = &#123;<span class="string">&#x27;School&#x27;</span>: [<span class="string">&#x27;SYSU&#x27;</span>,<span class="string">&#x27;THFLS&#x27;</span>,<span class="string">&#x27;JJXX&#x27;</span>], <span class="string">&#x27;Age&#x27;</span>: [<span class="number">20</span> ,<span class="number">21</span>, <span class="number">18</span>]&#125;</span><br><span class="line">df = pd.DataFrame(my_dict, index=indices)</span><br><span class="line"><span class="built_in">print</span>(df.shape)</span><br><span class="line"><span class="built_in">print</span>(df.columns)</span><br><span class="line"><span class="built_in">print</span>(df.index)</span><br><span class="line"><span class="built_in">print</span>(df.dtypes)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605249.png" alt=""></p><h3 id="3-3-增删查改">3.3 增删查改</h3><p>增加列</p><ul><li>直接通过给列标签赋值即可</li><li>使用 <code>DataFrame.assign(name=value)</code> 方法</li><li>使用 <code>DataFrame.insert(idx, name, value)</code></li><li>使用 <code>pd.merge(df1, df2, left_index=True, right_index=True)</code></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">indices = [<span class="string">&#x27;Dasi&#x27;</span>, <span class="string">&#x27;Jason&#x27;</span>, <span class="string">&#x27;wyw&#x27;</span>]</span><br><span class="line">my_dict = &#123;<span class="string">&#x27;School&#x27;</span>: [<span class="string">&#x27;SYSU&#x27;</span>,<span class="string">&#x27;THFLS&#x27;</span>,<span class="string">&#x27;JJXX&#x27;</span>], <span class="string">&#x27;Age&#x27;</span>: [<span class="number">95</span>,<span class="number">92</span>,<span class="number">93</span>]&#125;</span><br><span class="line">df = pd.DataFrame(my_dict, index=indices)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line">df[<span class="string">&#x27;Gender&#x27;</span>] = [<span class="string">&#x27;Female&#x27;</span>, <span class="string">&#x27;Male&#x27;</span>, <span class="string">&#x27;Male&#x27;</span>]</span><br><span class="line">df = df.assign(Height=[<span class="number">180</span>, <span class="number">160</span>, <span class="number">178</span>])</span><br><span class="line">df.insert(<span class="number">2</span>, <span class="string">&#x27;Weight&#x27;</span>, [<span class="number">88</span>, <span class="number">78</span>, <span class="number">60</span>])</span><br><span class="line">df2 = pd.DataFrame(data=[<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;O&#x27;</span>], columns=[<span class="string">&#x27;Blood&#x27;</span>], index = df.index)</span><br><span class="line">df = pd.merge(df, df2, left_index=<span class="literal">True</span>, right_index=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605250.png" alt=""></p><p>增加行</p><ul><li>可以直接通过 loc 新标签来赋值</li><li>可以使用 <code>pd.concat([df1, df2])</code> 将一个 df2 拼接在 df1 后面</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">indices = [<span class="string">&#x27;Dasi&#x27;</span>, <span class="string">&#x27;Jason&#x27;</span>, <span class="string">&#x27;wyw&#x27;</span>]</span><br><span class="line">my_dict = &#123;<span class="string">&#x27;School&#x27;</span>: [<span class="string">&#x27;SYSU&#x27;</span>,<span class="string">&#x27;THFLS&#x27;</span>,<span class="string">&#x27;JJXX&#x27;</span>], <span class="string">&#x27;Age&#x27;</span>: [<span class="number">20</span> ,<span class="number">21</span>, <span class="number">18</span>]&#125;</span><br><span class="line">df = pd.DataFrame(my_dict, index=indices)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line">df.loc[<span class="string">&#x27;Wan&#x27;</span>] = [<span class="string">&#x27;MiLuo&#x27;</span>, <span class="number">5</span>]</span><br><span class="line">add_df = pd.DataFrame([[<span class="string">&#x27;GZHU&#x27;</span>, <span class="number">22</span>]], index=[<span class="string">&#x27;Di&#x27;</span>], columns=df.columns)</span><br><span class="line">df = pd.concat([df, add_df])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605252.png" alt=""></p><p>删除列：使用 <code>DataFrame.drop(index, axis, inplace)</code> 方法，其中 index 指定行或列的标签，axis=1 表示删除列，axis=0 表示删除行，inplace 选择是否原地修改</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">indices = [<span class="string">&#x27;Dasi&#x27;</span>, <span class="string">&#x27;Jason&#x27;</span>, <span class="string">&#x27;wyw&#x27;</span>]</span><br><span class="line">my_dict = &#123;<span class="string">&#x27;School&#x27;</span>: [<span class="string">&#x27;SYSU&#x27;</span>,<span class="string">&#x27;THFLS&#x27;</span>,<span class="string">&#x27;JJXX&#x27;</span>], <span class="string">&#x27;Age&#x27;</span>: [<span class="number">20</span> ,<span class="number">21</span>, <span class="number">18</span>]&#125;</span><br><span class="line">df = pd.DataFrame(my_dict, index=indices)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line">df.drop(<span class="string">&#x27;School&#x27;</span>, axis=<span class="number">1</span>, inplace=<span class="literal">True</span>)</span><br><span class="line">df.drop(<span class="string">&#x27;wyw&#x27;</span>, axis=<span class="number">0</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605253.png" alt=""></p><p>查询：除了 loc、iloc 查询，DataFrame 还支持以下两个方法</p><ul><li>query：用列标签对应的值的条件选择，侧重于数值查找</li><li>filter：直接用行标签或列标签进行条件选择，侧重于名称查找</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">indices = [<span class="string">&#x27;Dasi&#x27;</span>, <span class="string">&#x27;Jason&#x27;</span>, <span class="string">&#x27;wyw&#x27;</span>]</span><br><span class="line">my_dict = &#123;<span class="string">&#x27;School&#x27;</span>: [<span class="string">&#x27;SYSU&#x27;</span>,<span class="string">&#x27;THFLS&#x27;</span>,<span class="string">&#x27;JJXX&#x27;</span>], <span class="string">&#x27;Age&#x27;</span>: [<span class="number">20</span> ,<span class="number">21</span>, <span class="number">18</span>], <span class="string">&#x27;Score&#x27;</span>: [<span class="number">95</span>, <span class="number">88</span>, <span class="number">92</span>]&#125;</span><br><span class="line">df = pd.DataFrame(my_dict, index=indices)</span><br><span class="line"><span class="built_in">print</span>(df.query(<span class="string">&#x27;Age &gt;= 20&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(df.<span class="built_in">filter</span>(like=<span class="string">&#x27;S&#x27;</span>, axis=<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(df.<span class="built_in">filter</span>(regex=<span class="string">&#x27;^.*e&#x27;</span>, axis=<span class="number">1</span>))</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605254.png" alt=""></p><p>修改行或列</p><ul><li>利用 loc、iloc 确定行列后直接修改</li><li>可以根据列标签直接修改</li><li>apply：对元素的值进行条件修改</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">indices = [<span class="string">&#x27;Dasi&#x27;</span>, <span class="string">&#x27;Jason&#x27;</span>, <span class="string">&#x27;wyw&#x27;</span>]</span><br><span class="line">my_dict = &#123;<span class="string">&#x27;School&#x27;</span>: [<span class="string">&#x27;SYSU&#x27;</span>,<span class="string">&#x27;THFLS&#x27;</span>,<span class="string">&#x27;JJXX&#x27;</span>], <span class="string">&#x27;Age&#x27;</span>: [<span class="number">20</span> , <span class="number">21</span>, <span class="number">18</span>], <span class="string">&#x27;Score&#x27;</span>: [<span class="number">95</span>, <span class="number">88</span>, <span class="number">92</span>]&#125;</span><br><span class="line">df = pd.DataFrame(my_dict, index=indices)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line">df.iloc[<span class="number">0</span>] = [<span class="string">&#x27;SYSU_&#x27;</span>, <span class="number">18</span>, <span class="number">95</span>]</span><br><span class="line">df.loc[<span class="string">&#x27;wyw&#x27;</span>, <span class="string">&#x27;Age&#x27;</span>] = <span class="number">22</span></span><br><span class="line">df[<span class="string">&#x27;Score&#x27;</span>] = df[<span class="string">&#x27;Score&#x27;</span>].apply(<span class="keyword">lambda</span> x : x-<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605255.png" alt=""></p><h3 id="3-4-重塑">3.4 重塑</h3><p>将数据表从长模式转为宽模式，即将原先的属性值作为行标签和列标签，注意返回的将会是一个 MultiIndex DataFrame</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.pivot(index, columns, values)</span><br></pre></td></tr></table></figure><ul><li>index：指定列标签的值作为新的行索引</li><li>columns：指定列标签的值作为新的列索引</li><li>values：指定列标签的值作为每个单元格的值</li></ul><p>将数据表从宽模式转为长模式，即将原先的属性值作为行标签和列标签</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.melt(id_vars, var_name, value_name)</span><br></pre></td></tr></table></figure><ul><li>id_vars：指定不需要转换的列，即保留下来的标识列</li><li>var_name：存放各列索引的列标签名字</li><li>value_name：存放各单元格值的列标签名字</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;date&#x27;</span>: [<span class="string">&#x27;2025-04-01&#x27;</span>, <span class="string">&#x27;2025-04-01&#x27;</span>, <span class="string">&#x27;2025-04-02&#x27;</span>, <span class="string">&#x27;2025-04-02&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;city&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;temperature&#x27;</span>: [<span class="number">20</span>, <span class="number">25</span>, <span class="number">22</span>, <span class="number">27</span>],</span><br><span class="line">    <span class="string">&#x27;sunny&#x27;</span>: [<span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">True</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;原始数据:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br><span class="line">df_pivot = df.pivot(index=<span class="string">&#x27;date&#x27;</span>, columns=<span class="string">&#x27;city&#x27;</span>, values=<span class="string">&#x27;temperature&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nPivot 后的宽格式 DataFrame:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df_pivot)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n重置行索引后的 DataFrame:&quot;</span>)</span><br><span class="line">df_reset = df_pivot.reset_index()</span><br><span class="line"><span class="built_in">print</span>(df_reset)</span><br><span class="line"></span><br><span class="line">df_melt = df_reset.melt(id_vars=<span class="string">&#x27;date&#x27;</span>, var_name=<span class="string">&#x27;city&#x27;</span>, value_name=<span class="string">&#x27;temperature&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nMelt 后的长格式 DataFrame:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df_melt)</span><br></pre></td></tr></table></figure><p><code>DataFrame.transpose()</code> 和 <code>DataFrame.T</code> 将行和列互换</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">indices = [<span class="string">&#x27;Dasi&#x27;</span>, <span class="string">&#x27;Jason&#x27;</span>, <span class="string">&#x27;wyw&#x27;</span>]</span><br><span class="line">my_dict = &#123;<span class="string">&#x27;School&#x27;</span>: [<span class="string">&#x27;SYSU&#x27;</span>,<span class="string">&#x27;THFLS&#x27;</span>,<span class="string">&#x27;JJXX&#x27;</span>], <span class="string">&#x27;Age&#x27;</span>: [<span class="number">20</span> , <span class="number">21</span>, <span class="number">18</span>], <span class="string">&#x27;Score&#x27;</span>: [<span class="number">95</span>, <span class="number">88</span>, <span class="number">92</span>]&#125;</span><br><span class="line">df = pd.DataFrame(my_dict, index=indices)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(df.T)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605256.png" alt=""></p><h2 id="4-CSV">4. CSV</h2><p>CSV（Comma-Separated Values）即逗号分隔值，其文件以纯文本形式存储表格数据，实际应用中，pandas 经常被用来对 csv 类型的表格数据进行处理。</p><p>下面使用菜鸟教程提供的 <a target="_blank" rel="noopener" href="https://static.jyshare.com/download/nba.csv">csv 数据</a>进行分析</p><h3 id="4-1-read-csv">4.1 read_csv</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(path_or_buf, sep=<span class="string">&#x27;,&#x27;</span>, header=<span class="string">&#x27;infer&#x27;</span>, names=<span class="literal">None</span>, usecols=<span class="literal">None</span>, dtype=<span class="literal">None</span>, nrows=<span class="literal">None</span>, skiprows=<span class="literal">None</span>, skipfooter=<span class="number">0</span>, encoding=<span class="literal">None</span>, na_values=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>功能</th></tr></thead><tbody><tr><td>sep</td><td>字段分隔符，默认是英文逗号’,’</td></tr><tr><td>header</td><td>指定哪一行作为列标题，默认为 0 即第一行，可以设置为 None 表示没有标题</td></tr><tr><td>names</td><td>传入一个列表自定义列名</td></tr><tr><td>usecols</td><td>指定需要读取的列，可以传入列名的列表或列索引的列表</td></tr><tr><td>dtype</td><td>将读取的数据转换为指定的数据类型，可以传入字典来为不同的列设置不同的数据类型</td></tr><tr><td>nrows</td><td>指定只读取前 n 行数据</td></tr><tr><td>skiprows</td><td>用于跳过文件开头的若干行数据，传入整数表示跳过前几行；也可以传入一个列表，指定需要跳过的具体行号。</td></tr><tr><td>skipfooter</td><td>指定跳过文件末尾的若干行</td></tr><tr><td>encoding</td><td>文件的编码格式，常用的有 utf-8 或 latin1</td></tr><tr><td>na_values</td><td>传入一个列表指定哪些值被认为是缺失值</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;nba.csv&#x27;</span>, sep=<span class="string">&#x27;,&#x27;</span>, usecols=[<span class="string">&#x27;Name&#x27;</span>, <span class="string">&#x27;Age&#x27;</span>, <span class="string">&#x27;Weight&#x27;</span>], header=<span class="number">0</span>, dtype=&#123;<span class="string">&#x27;Age&#x27;</span>: <span class="built_in">int</span>, <span class="string">&#x27;Weight&#x27;</span>: <span class="built_in">float</span>&#125;, nrows=<span class="number">100</span>, na_values=[<span class="string">&#x27;NA&#x27;</span>, <span class="string">&#x27;--&#x27;</span>, <span class="string">&#x27;&#x27;</span>], encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605257.png" alt=""></p><h3 id="4-2-to-csv">4.2 to_csv</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.to_csv(path_or_buf, sep=<span class="string">&#x27;,&#x27;</span>, columns=<span class="literal">None</span>, header=<span class="literal">True</span>, index=<span class="literal">True</span>, encoding=<span class="literal">None</span>, line_terminator=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>功能</th></tr></thead><tbody><tr><td>sep</td><td>指定字段之间的分隔符，默认是英文逗号 <code>,</code></td></tr><tr><td>index</td><td>是否将行索引写入 CSV 文件，默认为 True</td></tr><tr><td>header</td><td>是否将列标题写入 CSV 文件，默认为 True</td></tr><tr><td>columns</td><td>指定要写入 CSV 文件的列的列表，若不指定则写入所有列</td></tr><tr><td>line_terminator</td><td>指定行结束符，默认为 <code>\n</code></td></tr><tr><td>encoding</td><td>指定输出文件的编码格式</td></tr></tbody></table><p>除了上述之外，to_csv() 还专门提供了处理引号的参数</p><ul><li>quoting：决定了哪些字段会被包裹在引号中<ul><li>0/csv.QUOTE_MINIMAL：只有当字段包含特殊字符（例如分隔符、换行符、或引号）时，才会自动加上引号</li><li>1/csv.QUOTE_ALL：所有字段都会被引号包裹</li><li>2/csv.QUOTE_NONNUMERIC：所有非数字字段都会被引号包裹</li><li>3/csv.QUOTE_NONE：不使用引号包裹任何字段</li></ul></li><li>quotechar：指定决定了在字段内部出现引号时，是自动重复引号（True），还是使用 escapechar 来转义</li><li>doublequote：True 表示当字段中出现引号字符时，会使用两个连续的引号来表示一个引号</li><li>escapechar：指定了用于转义特殊字符的字符</li></ul><h2 id="5-JSON">5. JSON</h2><p>JSON（JavaScript Object Notation）即JavaScript 对象标记法，是轻量级的文本数据交换格式</p><p>下面使用菜鸟教程提供的 <a target="_blank" rel="noopener" href="https://static.jyshare.com/download/sites.json">JSON 数据</a>进行分析</p><blockquote><p>所以我一直没搞懂 json 到底怎么念，有些人念“鸡森”，有些人念“杰森”，还有些人念“杰尚”，还是干脆直接念 J-S-O-N…</p></blockquote><h3 id="5-1-JSON-简介">5.1 JSON 简介</h3><p>在这里简要提一下 JSON 的作用和意义，它实际上是现实生活中经常接触到的文件。</p><p>JSON 按照我的理解就是嵌套键值对，当然官方说明是嵌套的对象和数组，先人给 JSON 制定了简单但极其严格的语法规范，并且极其严格地限制了可以使用的数据类型，保证了跨语言、跨平台的数据交换和存储的高效性、一致性和可读性，从而方便网络传输和机器解析。</p><p>基本数据类型</p><ul><li>字符串：必须由双引号 “” 包裹，注意只能是双引号！</li><li>数值：可以是整数或浮点数，不需要引号</li><li>布尔值：只有 true 和 false 两个值</li><li>null：表示空值或无数据</li></ul><p>复合数据类型</p><ul><li>对象：由一对大括号 {} 包裹，内部由零个或多个键值对构成，键必须是字符串，键和值之间用冒号 : 分隔，每个键值对之间用逗号 , 分隔（注意最后一个键值对不需要额外的逗号）</li><li>数组：由一对方括号 [] 包裹，内部包含零个或多个元素，各元素之间用逗号 , 分隔，元素可以是任意 JSON 支持的数据类型</li></ul><p>嵌套数据类型：通常最外层表示一个实体，内层表示若干属性，数组表示属性的若干取值</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;person&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Dasi&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">21</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;hobbies&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;reading&quot;</span><span class="punctuation">,</span> <span class="string">&quot;cycling&quot;</span><span class="punctuation">,</span> <span class="string">&quot;swimming&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;street&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4 ZhiShan SYSU&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;city&quot;</span><span class="punctuation">:</span> <span class="string">&quot;GuangZhou&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;isStudent&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;isMarried&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>JSON 格式</p><table><thead><tr><th>格式</th><th>描述</th><th>结果</th></tr></thead><tbody><tr><td>split</td><td>使用 index、columns 和 data 分割</td><td>{“index”:[“a”,“b”],“columns”:[“A”,“B”],“data”:[[1,2],[3,4]]}</td></tr><tr><td>records</td><td>每一行都是一个字典</td><td>[{“A”:1,“B”:2},{“A”:3,“B”:4}]</td></tr><tr><td>index</td><td>索引为键，值为字典</td><td>{“a”:{“A”:1,“B”:2},“b”:{“A”:3,“B”:4}}</td></tr><tr><td>columns</td><td>列名为键，值为字典</td><td>{“A”:{“a”:1,“b”:3},“B”:{“a”:2,“b”:4}}</td></tr><tr><td>values</td><td>只有数据</td><td>[[1,2],[3,4]]</td></tr></tbody></table><h3 id="5-2-read-json">5.2 read_json</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_json(path_or_buf, orient=<span class="literal">None</span>, dtype=<span class="literal">None</span>, convert_axes=<span class="literal">True</span>, convert_dates=<span class="literal">True</span>, encoding=<span class="literal">None</span>, keep_default_na=<span class="literal">True</span>,)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>功能</th></tr></thead><tbody><tr><td>orient</td><td>定义 JSON 数据的格式方式</td></tr><tr><td>dtype</td><td>指定列的数据类型</td></tr><tr><td>convert_axes</td><td>是否将轴转换为合适的数据类型</td></tr><tr><td>convert_dates</td><td>是否将日期解析为日期类型</td></tr><tr><td>keep_default_na</td><td>指定是否保留默认的 NA 值</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[</span></span><br><span class="line"><span class="string">    &#123;&quot;Name&quot;: &quot;Alice&quot;, &quot;Age&quot;: 25, &quot;City&quot;: &quot;New York&quot;&#125;,</span></span><br><span class="line"><span class="string">    &#123;&quot;Name&quot;: &quot;Bob&quot;, &quot;Age&quot;: 30, &quot;City&quot;: &quot;Los Angeles&quot;&#125;,</span></span><br><span class="line"><span class="string">    &#123;&quot;Name&quot;: &quot;Charlie&quot;, &quot;Age&quot;: 35, &quot;City&quot;: &quot;Chicago&quot;&#125;</span></span><br><span class="line"><span class="string">]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">df = pd.read_json(<span class="string">&quot;data.json&quot;</span>, orient=<span class="string">&#x27;records&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605258.png" alt=""></p><p><code>pd.json_normalize()</code> 用于将嵌套 JSON 数据“扁平化”成一个平面表格，参数有</p><ul><li>record_path：指定需要展开的嵌套列表</li><li>meta：指定嵌套列表中要保留的其他元数据字段</li><li>errors：指定遇到不存在的字段时是 <code>raise</code> 报错还是 <code>ignore</code> 跳过</li><li>sep：指定元数据嵌套字段之间的分隔符，默认是 ‘.’</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;school_name&quot;</span>: <span class="string">&quot;SYSU&quot;</span>,</span><br><span class="line">    <span class="string">&quot;info&quot;</span> : &#123;</span><br><span class="line">        <span class="string">&quot;class&quot;</span>: <span class="string">&quot;Year 1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;president&quot;</span>: <span class="string">&quot;Dasi&quot;</span>,</span><br><span class="line">        <span class="string">&quot;contacts&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;email&quot;</span>: <span class="string">&quot;example@email.com&quot;</span>,</span><br><span class="line">            <span class="string">&quot;tel&quot;</span>: <span class="string">&quot;123456789&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;students&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: <span class="string">&quot;A001&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Tom&quot;</span>,</span><br><span class="line">        <span class="string">&quot;math&quot;</span>: <span class="number">60</span>,</span><br><span class="line">        <span class="string">&quot;physics&quot;</span>: <span class="number">66</span>,</span><br><span class="line">        <span class="string">&quot;chemistry&quot;</span>: <span class="number">61</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: <span class="string">&quot;A002&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;James&quot;</span>,</span><br><span class="line">        <span class="string">&quot;math&quot;</span>: <span class="number">89</span>,</span><br><span class="line">        <span class="string">&quot;physics&quot;</span>: <span class="number">76</span>,</span><br><span class="line">        <span class="string">&quot;chemistry&quot;</span>: <span class="number">51</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: <span class="string">&quot;A003&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Jenny&quot;</span>,</span><br><span class="line">        <span class="string">&quot;math&quot;</span>: <span class="number">79</span>,</span><br><span class="line">        <span class="string">&quot;physics&quot;</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="string">&quot;chemistry&quot;</span>: <span class="number">78</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.json_normalize(</span><br><span class="line">    data,</span><br><span class="line">    record_path =[<span class="string">&#x27;students&#x27;</span>],</span><br><span class="line">    meta=[</span><br><span class="line">        <span class="string">&quot;school_name&quot;</span>,</span><br><span class="line">        [<span class="string">&quot;info&quot;</span>, <span class="string">&quot;class&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;info&quot;</span>, <span class="string">&quot;contacts&quot;</span>, <span class="string">&quot;tel&quot;</span>]</span><br><span class="line">    ],</span><br><span class="line">    sep=<span class="string">&quot;:&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605259.png" alt=""></p><h3 id="5-3-to-json">5.3 to_json</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.to_json(path_or_buf, orient=<span class="literal">None</span>, date_format=<span class="literal">None</span>, double_precision=<span class="number">10</span>, force_ascii=<span class="literal">True</span>, date_unit=<span class="string">&#x27;ms&#x27;</span>, default_handler=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>orient</td><td>指定生成的 JSON 数据的结构方式</td></tr><tr><td>default_handler</td><td>提供一个处理函数，将这些对象转换为可序列化的格式</td></tr><tr><td>lines</td><td>布尔值，只适用于 records 格式，将每个 DataFrame 行生成一行 JSON 文本</td></tr><tr><td>encoding</td><td>指定输出 JSON 文件的编码格式</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;Name&#x27;</span>: [<span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Charlie&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Age&#x27;</span>: [<span class="number">25</span>, <span class="number">30</span>, <span class="number">35</span>],</span><br><span class="line">    <span class="string">&#x27;City&#x27;</span>: [<span class="string">&#x27;New York&#x27;</span>, <span class="string">&#x27;Los Angeles&#x27;</span>, <span class="string">&#x27;Chicago&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line">df.to_json(<span class="string">&#x27;data.json&#x27;</span>, orient=<span class="string">&#x27;records&#x27;</span>, lines=<span class="literal">True</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#123;&quot;Name&quot;:&quot;Alice&quot;,&quot;Age&quot;:25,&quot;City&quot;:&quot;New York&quot;&#125;,</span></span><br><span class="line"><span class="string">&#123;&quot;Name&quot;:&quot;Bob&quot;,&quot;Age&quot;:30,&quot;City&quot;:&quot;Los Angeles&quot;&#125;,</span></span><br><span class="line"><span class="string">&#123;&quot;Name&quot;:&quot;Charlie&quot;,&quot;Age&quot;:35,&quot;City&quot;:&quot;Chicago&quot;&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><blockquote><p>每个记录独占一行，不会被包含在一个外部的数组，即最外层没有方括号 []</p></blockquote><h2 id="6-数据清洗">6. 数据清洗</h2><h3 id="6-1-缺失值处理">6.1 缺失值处理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.dropna(axis=<span class="number">0</span>, how=<span class="string">&#x27;any&#x27;</span>, thresh=<span class="literal">None</span>, subset=<span class="literal">None</span>, inplace=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>axis</td><td>0 删除行，1 删除列</td></tr><tr><td>how</td><td><code>any</code> 只要存在至少一个缺失值就删除，<code>all</code> 表示只有当所有值都是缺失值才删除</td></tr><tr><td>thresh</td><td>指定保留行或列所需的最少非缺失值数量</td></tr><tr><td>subset</td><td>传递列字段组成的列表，仅在这些列上检查缺失值</td></tr><tr><td>inplace</td><td>True 直接在原 DataFrame 上修改，False 返回修改后新的 DataFrame</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&quot;A&quot;</span>: [<span class="number">1</span>, <span class="number">2</span>, pd.NA, <span class="number">4</span>],</span><br><span class="line">    <span class="string">&quot;B&quot;</span>: [pd.NA, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    <span class="string">&quot;C&quot;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    <span class="string">&quot;D&quot;</span>: [pd.NA, pd.NA, pd.NA, pd.NA]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;原始&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n对行：any&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.dropna(axis=<span class="number">0</span>, how=<span class="string">&#x27;any&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n对行：thresh=3&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.dropna(axis=<span class="number">0</span>, thresh=<span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n对列：any&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.dropna(axis=<span class="number">1</span>, how=<span class="string">&#x27;any&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n对列：all&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.dropna(axis=<span class="number">1</span>, how=<span class="string">&#x27;all&#x27;</span>))</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605260.png" alt=""></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.fillna(axis=<span class="number">0</span>, value=<span class="literal">None</span>, method=<span class="literal">None</span>, limit=<span class="literal">None</span>, inplace=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>axis</td><td>0 填充行，1 填充列</td></tr><tr><td>value</td><td>用来替换缺失值的值，可以是单个标量或标签为键的字典</td></tr><tr><td>method</td><td><code>ffill</code> 表示用前一个非空值填充缺失值，<code>bfill</code> 表示用后一个非空值填充缺失值</td></tr><tr><td>limit</td><td>指定最大连续填充缺失值的数量</td></tr><tr><td>inplace</td><td>True 直接在原 DataFrame 上修改，False 返回修改后新的 DataFrame</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&quot;A&quot;</span>: [<span class="number">1</span>, <span class="number">2</span>, pd.NA, <span class="number">4</span>],</span><br><span class="line">    <span class="string">&quot;B&quot;</span>: [pd.NA, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    <span class="string">&quot;C&quot;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    <span class="string">&quot;D&quot;</span>: [pd.NA, pd.NA, pd.NA, pd.NA]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;原始&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n填充 0&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.fillna(axis=<span class="number">0</span>, value=<span class="number">0</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n每一行根据列标签填充&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.fillna(axis=<span class="number">0</span>, value=&#123;<span class="string">&quot;A&quot;</span>:<span class="number">1</span>, <span class="string">&quot;B&quot;</span>:<span class="number">2</span>, <span class="string">&quot;C&quot;</span>:<span class="number">3</span>, <span class="string">&quot;D&quot;</span>:<span class="number">4</span>&#125;))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n每一列向前填充&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.fillna(axis=<span class="number">0</span>, method=<span class="string">&quot;ffill&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n每一列最多填充 2 个&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.fillna(axis=<span class="number">0</span>, value=<span class="number">0</span>, limit=<span class="number">2</span>))</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605261.png" alt=""></p><blockquote><p>替换空单元格的常用方法是均值（<code>df.mean(axis)</code>）、中位数值（<code>df.median(axis)</code>）或众数（<code>df.mode(axis)</code>），其中 <code>axis=0</code> 表示计算每一列，<code>axis=1</code> 表示计算每一行</p></blockquote><h3 id="6-2-重复值处理">6.2 重复值处理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.drop_duplicates(subset=<span class="literal">None</span>, keep=<span class="string">&#x27;first&#x27;</span>, inplace=<span class="string">&#x27;Fasle&#x27;</span>, ignore_index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>subset</td><td>传递列标签的列表，指定用来判定在该列上的取值是否重复</td></tr><tr><td>keep</td><td><code>first</code> 保留第一次出现的记录，<code>last</code> 保留最后一次出现的记录，<code>false</code> 不保留任何记录</td></tr><tr><td>inplace</td><td>True 直接在原 DataFrame 上修改，False 返回修改后新的 DataFrame</td></tr><tr><td>ignore_index</td><td>True 表示从 0 开始重置索引，False 返回原来的索引</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&quot;ID&quot;</span>: [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="string">&quot;Name&quot;</span>: [<span class="string">&quot;Dasi&quot;</span>, <span class="string">&quot;Dasi&quot;</span>, <span class="string">&quot;wyw&quot;</span>, <span class="string">&quot;wyw&quot;</span>, <span class="string">&quot;jason&quot;</span>, <span class="string">&quot;jason&quot;</span>],</span><br><span class="line">    <span class="string">&quot;Gender&quot;</span>: [<span class="string">&quot;Male&quot;</span>, <span class="string">&quot;Male&quot;</span>, <span class="string">&quot;Male&quot;</span>, <span class="string">&quot;Male&quot;</span>, <span class="string">&quot;Male&quot;</span>, <span class="string">&quot;Female&quot;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;原始&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n保留第一次&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.drop_duplicates(keep=<span class="string">&#x27;first&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n保留最后一次&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.drop_duplicates(keep=<span class="string">&#x27;last&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n不保留&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.drop_duplicates(keep=<span class="literal">False</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n筛选&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.drop_duplicates(keep=<span class="string">&#x27;first&#x27;</span>, subset=[<span class="string">&quot;ID&quot;</span>, <span class="string">&quot;Name&quot;</span>], ignore_index=<span class="literal">True</span>))</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605262.png" alt=""></p><h3 id="6-3-异常值处理">6.3 异常值处理</h3><p>对于数值型数据，通常使用两种方法定义异常值</p><p>IQR = Q3 - Q1：数据的第一四分位数和第三四分位数相减得到四分位距，通常认为低于 Q1 - 1.5IQR 或高于 Q3 + 1.5IQR 的数据为异常值，可以直接利用 <code>DataFrame.quantile(x)</code> 获得数据的 x 分位数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&quot;ID&quot;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>],</span><br><span class="line">    <span class="string">&quot;score&quot;</span>: [<span class="number">85</span>, <span class="number">60</span>, <span class="number">88</span>, <span class="number">87</span>, <span class="number">92</span>, <span class="number">120</span>, <span class="number">85</span>, <span class="number">94</span>, <span class="number">92</span>]</span><br><span class="line">&#125;)</span><br><span class="line">Q1 = df[<span class="string">&#x27;score&#x27;</span>].quantile(<span class="number">0.25</span>)</span><br><span class="line">Q3 = df[<span class="string">&#x27;score&#x27;</span>].quantile(<span class="number">0.75</span>)</span><br><span class="line">IQR = Q3 - Q1</span><br><span class="line">lower_bound = Q1 - <span class="number">1.5</span> * IQR</span><br><span class="line">upper_bound = Q3 + <span class="number">1.5</span> * IQR</span><br><span class="line">outliers = (df[<span class="string">&#x27;score&#x27;</span>] &lt; lower_bound) | (df[<span class="string">&#x27;score&#x27;</span>] &gt; upper_bound)</span><br></pre></td></tr></table></figure><p>Z-Score = abs((x_i - x_mean) / x_std)：计算每个数据点与均值的偏离程度，大于某个阈值则认为是异常值，可以直接利用 <code>DataFrame.mean()</code> 和 <code>DataFrame.std()</code> 获取均值和标准差</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&quot;ID&quot;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>],</span><br><span class="line">    <span class="string">&quot;score&quot;</span>: [<span class="number">85</span>, <span class="number">60</span>, <span class="number">88</span>, <span class="number">87</span>, <span class="number">92</span>, <span class="number">120</span>, <span class="number">85</span>, <span class="number">94</span>, <span class="number">92</span>]</span><br><span class="line">&#125;)</span><br><span class="line">mean_val = df[<span class="string">&#x27;score&#x27;</span>].mean()</span><br><span class="line">std_val = df[<span class="string">&#x27;score&#x27;</span>].std()</span><br><span class="line">z_score = (df[<span class="string">&#x27;score&#x27;</span>] - mean_val) / std_val</span><br><span class="line">outliers = <span class="built_in">abs</span>(z_score) &gt; <span class="number">1.0</span></span><br></pre></td></tr></table></figure><p>删除异常值：用取反操作 <code>~</code> 来保留正常值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = df[~outliers]</span><br></pre></td></tr></table></figure><p>替换异常值：选择中位数/均值/众数充当替换的值，然后利用 <code>DataFrame.loc()</code> 确定行列索引来赋值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[outliers, <span class="string">&#x27;score&#x27;</span>] = df[<span class="string">&#x27;score&#x27;</span>].median()</span><br></pre></td></tr></table></figure><h3 id="6-4-替换值处理">6.4 替换值处理</h3><p><code>DataFrame.replace(to_replace=None, value=None, regex=False)</code> 用于将 DataFrame 中指定的值替换为其它值，支持替换单值替换、多值替换，字典映射替换以及正则表达式替换</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&quot;Value&quot;</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>],</span><br><span class="line">    <span class="string">&quot;Fruit&quot;</span>: [<span class="string">&quot;Banana&quot;</span>, <span class="string">&quot;Berry&quot;</span>, <span class="string">&quot;Apple&quot;</span>, <span class="string">&quot;Grape&quot;</span>, <span class="string">&quot;Bennet&quot;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;单个值&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.replace(to_replace=<span class="number">0</span>, value=pd.NA))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n多个值&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.replace(to_replace=[<span class="number">0</span>,<span class="number">1</span>], value=pd.NA))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n字典&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.replace(to_replace=&#123;<span class="string">&quot;Value&quot;</span>: &#123;<span class="number">0</span>: pd.NA&#125;, <span class="string">&quot;Fruit&quot;</span>: &#123;<span class="string">&quot;Berry&quot;</span>: <span class="string">&quot;Blueberry&quot;</span>&#125;&#125;))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n正则表达式&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.replace(to_replace=<span class="string">r&#x27;^B.*&#x27;</span>, value=<span class="string">&#x27;B-fruit&#x27;</span>, regex=<span class="literal">True</span>))</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605268.png" alt=""></p><h2 id="7-数据预处理">7. 数据预处理</h2><h3 id="7-1-格式转换">7.1 格式转换</h3><p>数据类型转换 <code>DataFrame.astype(dtype, copy)</code></p><ul><li>传递单一数据类型：表示对所有元素应用</li><li>传递字典：键为列名，值为目标数据类型</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&quot;ID&quot;</span>: [<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>, <span class="number">5.0</span>, <span class="number">6.0</span>, <span class="number">7.0</span>, <span class="number">8.0</span>, <span class="number">9.0</span>],</span><br><span class="line">    <span class="string">&quot;score&quot;</span>: [<span class="number">85</span>, <span class="number">60</span>, <span class="number">88</span>, <span class="number">87</span>, <span class="number">92</span>, <span class="number">120</span>, <span class="number">85</span>, <span class="number">94</span>, <span class="number">92</span>]</span><br><span class="line">&#125;)</span><br><span class="line">df = df.astype(dtype=&#123;<span class="string">&quot;ID&quot;</span>:<span class="built_in">int</span>, <span class="string">&quot;score&quot;</span>:<span class="built_in">float</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605263.png" alt=""></p><p>日期类型转换</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.to_datetime(data, dayfirst=<span class="literal">False</span>, yearfirst=<span class="literal">False</span>, utc=<span class="literal">None</span>, <span class="built_in">format</span>=<span class="literal">None</span>, exact=<span class="literal">True</span>, unit=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>dayfirst</td><td>布尔值，表示第一部分为日，如 DD/MM/YYYY</td></tr><tr><td>yearfirst</td><td>布尔值，表示第一部分为年，如 YYYY/MM/DD</td></tr><tr><td>format</td><td>指定日期字符串的解析格式，如 <code>'%Y-%m-%d'</code></td></tr><tr><td>exact</td><td>布尔值，表示严格按照 <code>format</code> 指定的格式解析日期</td></tr><tr><td>utc</td><td>布尔值，则返回带有 UTC 时区的日期时间</td></tr><tr><td>unit</td><td>指定该数值表示的时间单位，如 <code>'s'</code>（秒）、<code>'ms'</code>（毫秒）、<code>'us'</code>（微秒）、<code>'ns'</code>（纳秒）</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&quot;date&quot;</span>: [<span class="string">&quot;31/2020/12 12:30:00&quot;</span>, <span class="string">&quot;01/2021/01 18:48:23&quot;</span>, <span class="string">&quot;15/2021/06 01:05:06&quot;</span>]</span><br><span class="line">&#125;)</span><br><span class="line">df[<span class="string">&quot;date&quot;</span>] = pd.to_datetime(df[<span class="string">&quot;date&quot;</span>], utc=<span class="literal">True</span>, <span class="built_in">format</span>=<span class="string">&#x27;%d/%Y/%m %H:%M:%S&#x27;</span>, exact=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605264.png" alt=""></p><h3 id="7-2-数值处理">7.2 数值处理</h3><p>数值处理的主要目的是将原始数值数据转换为便于模型或机器学习容易处理的格式，可以消除数据量级的差异</p><p>标准化（Standardization）：将数据转换为均值为 0、标准差为 1 的标准高斯分布</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mean_val = df[<span class="string">&quot;value&quot;</span>].mean()</span><br><span class="line">std_val = df[<span class="string">&quot;value&quot;</span>].std()</span><br><span class="line">df[<span class="string">&quot;standardized&quot;</span>] = (df[<span class="string">&quot;value&quot;</span>] - mean_val) / std_val</span><br></pre></td></tr></table></figure><p>归一化（Normalization）是将数据缩放到 [0, 1] 区间内，其中最小值对应 0，最大值对应 1，其它值按比例分布</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">min_val = df[<span class="string">&quot;value&quot;</span>].<span class="built_in">min</span>()</span><br><span class="line">max_val = df[<span class="string">&quot;value&quot;</span>].<span class="built_in">max</span>()</span><br><span class="line">df[<span class="string">&quot;normalized&quot;</span>] = (df[<span class="string">&quot;value&quot;</span>] - min_val) / (max_val - min_val)</span><br></pre></td></tr></table></figure><h3 id="7-3-类别处理">7.3 类别处理</h3><p>标签编码：将每个唯一的类别映射到一个整数值</p><ul><li><code>DataFrame.astype(&quot;category&quot;)</code>：将类别列转换为 Pandas 的 “category” 类型</li><li><code>DataFrame.cat.categories</code>：获得 “category” 类型的类别列表</li><li><code>DataFrame.cat.catcodes</code>：获得 “category” 类型的类别编码</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&quot;ID&quot;</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>],</span><br><span class="line">    <span class="string">&quot;color&quot;</span>: [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;red&quot;</span>, <span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;yellow&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;red&quot;</span>]</span><br><span class="line">&#125;)</span><br><span class="line">color_label = df[<span class="string">&quot;color&quot;</span>].astype(<span class="string">&quot;category&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(color_label.cat.categories)</span><br><span class="line">df[<span class="string">&quot;color_code&quot;</span>] = color_label.cat.codes</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605265.png" alt=""></p><p>独热编码指的是将类别变量转换为数值变量的编码方法，如果某个样本属于该类别，则该列的值为 True/1，否则为 False/0</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.get_dummies(data, prefix=<span class="literal">None</span>, prefix_sep=<span class="string">&#x27;_&#x27;</span>, dummy_na=<span class="literal">False</span>, columns=<span class="literal">None</span>, sparse=<span class="literal">False</span>, drop_first=<span class="literal">False</span>, dtype=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>columns</td><td>指定需要进行独热编码的列，否则对所有非数值型列进行编码</td></tr><tr><td>prefix</td><td>为独热编码的列指定前缀，默认使用原列名</td></tr><tr><td>prefix_sep</td><td>前缀和类别值的分隔符，默认为 ‘_’</td></tr><tr><td>dummy_na</td><td>布尔值，指定是否为缺失值创建一个单独的独热编码列</td></tr><tr><td>dtype</td><td>指定独热编码列的数据类型，通常是布尔类型或整数类型</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&quot;ID&quot;</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    <span class="string">&quot;color&quot;</span>: [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>, pd.NA, <span class="string">&quot;red&quot;</span>]</span><br><span class="line">&#125;)</span><br><span class="line">df_dummies = pd.get_dummies(df[<span class="string">&quot;color&quot;</span>], prefix=<span class="string">&quot;color&quot;</span>, dummy_na=<span class="literal">True</span>, dtype=<span class="built_in">int</span>)</span><br><span class="line">df = pd.concat([df, df_dummies], axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605266.png" alt=""></p><h3 id="7-4-数据抽样">7.4 数据抽样</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.sample(n=<span class="literal">None</span>, frac=<span class="literal">None</span>, replace=<span class="literal">False</span>, weights=<span class="literal">None</span>, random_state=<span class="literal">None</span>, axis=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>n</td><td>要抽取的样本数量</td></tr><tr><td>frac</td><td>要抽取的样本比例</td></tr><tr><td>axis</td><td>0 是对行进行采样，1 是对列进行采样</td></tr><tr><td>replace</td><td>是否有放回抽样</td></tr><tr><td>weights</td><td>每个样本的抽样权重</td></tr><tr><td>random_state</td><td>控制随机种子，用于结果复现</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&quot;ID&quot;</span>: <span class="built_in">range</span>(<span class="number">10</span>),</span><br><span class="line">    <span class="string">&quot;Letter&quot;</span>: <span class="built_in">list</span>(<span class="string">&quot;abcdefghij&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(df.sample(frac=<span class="number">0.4</span>, axis=<span class="number">0</span>))</span><br><span class="line"><span class="built_in">print</span>(df.sample(n=<span class="number">3</span>, replace=<span class="literal">True</span>, axis=<span class="number">1</span>))</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605267.png" alt=""></p><h2 id="8-数值数据分析">8. 数值数据分析</h2><h3 id="8-1-排序">8.1 排序</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.sort_values(by, axis=<span class="number">0</span>, ascending=<span class="literal">True</span>, inplace=<span class="literal">False</span>, kind=<span class="string">&#x27;quicksort&#x27;</span>, na_position=<span class="string">&#x27;last&#x27;</span>, ignore_index=<span class="literal">False</span>, key=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>by</td><td>用于排序的列名，可以是单个列名可以是列明列表</td></tr><tr><td>axis</td><td>0 表示对列排序（默认），1 表示对行排序</td></tr><tr><td>ascending</td><td>布尔值，True 表示升序（默认），False 表示降序</td></tr><tr><td>inplace</td><td>布尔值，True 直接在原 DataFrame 修改，False 表示返回新对象（默认）</td></tr><tr><td>kind</td><td>排序算法，有 <code>quicksort</code>（默认）, <code>mergesort</code>, <code>heapsort</code></td></tr><tr><td>ignore_index</td><td>True 表示返回结果的索引将被重置为默认的整数索引</td></tr><tr><td>key</td><td>传递函数，用于在排序前对值进行映射</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&quot;A&quot;</span>: [<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="string">&quot;B&quot;</span>: [<span class="number">4</span>, <span class="number">8</span>, <span class="number">5</span>],</span><br><span class="line">    <span class="string">&quot;C&quot;</span>: [<span class="string">&quot;Banana&quot;</span>, <span class="string">&quot;apple&quot;</span>, <span class="string">&quot;Watermalon&quot;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(df.sort_values(by=<span class="string">&quot;A&quot;</span>, ascending=<span class="literal">True</span>))</span><br><span class="line"><span class="built_in">print</span>(df.sort_values(by=<span class="string">&quot;B&quot;</span>, ascending=<span class="literal">True</span>))</span><br><span class="line"><span class="built_in">print</span>(df.sort_values(by=<span class="string">&quot;C&quot;</span>, ascending=<span class="literal">True</span>, key=<span class="keyword">lambda</span> x:x.<span class="built_in">str</span>.lower()))</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605269.png" alt=""></p><h3 id="8-2-聚合">8.2 聚合</h3><p><code>DataFrame.groupby(by).agg(func)</code>：允许你根据一个或多个键（通常为列）将数据分组，然后对每个组应用聚合函数</p><ul><li>by：传递列名或列名列表进行分组</li><li>func：传递字典，指明对哪个列应用哪个聚合函数，可以是内置函数如 mean, sum, min, max, count, std 等，也可以是自定义函数</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;Department&#x27;</span>: [<span class="string">&#x27;HR&#x27;</span>, <span class="string">&#x27;Finance&#x27;</span>, <span class="string">&#x27;HR&#x27;</span>, <span class="string">&#x27;IT&#x27;</span>, <span class="string">&#x27;IT&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Employee&#x27;</span>: [<span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Charlie&#x27;</span>, <span class="string">&#x27;David&#x27;</span>, <span class="string">&#x27;Eve&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Gender&#x27;</span>: [<span class="string">&#x27;Female&#x27;</span>, <span class="string">&#x27;Male&#x27;</span>, <span class="string">&#x27;Female&#x27;</span>, <span class="string">&#x27;Male&#x27;</span>, <span class="string">&#x27;Female&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Salary&#x27;</span>: [<span class="number">50000</span>, <span class="number">60000</span>, <span class="number">55000</span>, <span class="number">70000</span>, <span class="number">75000</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;计算每个部门的平均薪资&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.groupby(<span class="string">&#x27;Department&#x27;</span>).agg(&#123;<span class="string">&#x27;Salary&#x27;</span>:<span class="string">&#x27;mean&#x27;</span>&#125;))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n计算男性和女性的薪资标准差&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.groupby(<span class="string">&#x27;Gender&#x27;</span>).agg(&#123;<span class="string">&#x27;Salary&#x27;</span>:<span class="string">&#x27;std&#x27;</span>&#125;))</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605270.png" alt=""></p><h3 id="8-3-自定义操作">8.3 自定义操作</h3><p>有时候我们不只是对分组的数据进行传统的求均值、最值等，而是按照自定义的逻辑，我们主要借助以下两个方法实现</p><ul><li><code>DataFrame.apply(func)</code>：对 DataFrame 的每个分组或每一行/列应用一个函数</li><li><code>lambda 参数: 表达式</code>：快速定义一个匿名函数，对给定可迭代对象的每个元素应用指定的表达式</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;Department&#x27;</span>: [<span class="string">&#x27;HR&#x27;</span>, <span class="string">&#x27;Finance&#x27;</span>, <span class="string">&#x27;HR&#x27;</span>, <span class="string">&#x27;IT&#x27;</span>, <span class="string">&#x27;IT&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Employee&#x27;</span>: [<span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Charlie&#x27;</span>, <span class="string">&#x27;David&#x27;</span>, <span class="string">&#x27;Eve&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Gender&#x27;</span>: [<span class="string">&#x27;Female&#x27;</span>, <span class="string">&#x27;Male&#x27;</span>, <span class="string">&#x27;Female&#x27;</span>, <span class="string">&#x27;Male&#x27;</span>, <span class="string">&#x27;Female&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Salary&#x27;</span>: [<span class="number">50000</span>, <span class="number">60000</span>, <span class="number">55000</span>, <span class="number">70000</span>, <span class="number">75000</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;性别分组后排序&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.groupby(<span class="string">&#x27;Gender&#x27;</span>).apply(<span class="keyword">lambda</span> x: x.sort_values(by=<span class="string">&quot;Salary&quot;</span>)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n部门分组后计算总和扣除税收5%&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.groupby(<span class="string">&#x27;Department&#x27;</span>).apply(<span class="keyword">lambda</span> x: x[<span class="string">&quot;Salary&quot;</span>].<span class="built_in">sum</span>() * <span class="number">0.95</span>))</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605271.png" alt=""></p><h3 id="8-4-透视">8.4 透视</h3><p>透视：在数据分析中指的是将数据进行重塑，即将某些列变为行标签，某些列变为列标签，然后在行列标签每个值对应的交叉点上进行汇总，最后对这些数据进行聚合，从而快速理解数据中不同维度之间的关系和分布情况</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pd.pivot_table(data, aggfunc=<span class="string">&#x27;mean&#x27;</span>, </span><br><span class="line">               values=<span class="literal">None</span>, index=<span class="literal">None</span>, columns=<span class="literal">None</span>, </span><br><span class="line">               fill_value=<span class="literal">None</span>, dropna=<span class="literal">True</span>, </span><br><span class="line">               margins=<span class="literal">False</span>, margins_name=<span class="string">&#x27;All&#x27;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>values</td><td>需要聚合的列，可以是单个列名或列名列表，如果不指定则默认是所有数值列</td></tr><tr><td>index</td><td>指定作为行标签的列</td></tr><tr><td>columns</td><td>指定作为列标签的列</td></tr><tr><td>aggfunc</td><td>聚合函数或自定义函数</td></tr><tr><td>fill_value</td><td>聚合结果中将缺失值替换为指定的值</td></tr><tr><td>dropna</td><td>布尔值，True 会丢弃全部为 NaN 的列</td></tr><tr><td>margins</td><td>布尔值，True 则会添加一行和一列显示汇总统计</td></tr><tr><td>margins_name</td><td>设置汇总行和汇总列的名称</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&quot;Department&quot;</span>: [<span class="string">&quot;HR&quot;</span>, <span class="string">&quot;Finance&quot;</span>, <span class="string">&quot;HR&quot;</span>, <span class="string">&quot;IT&quot;</span>, <span class="string">&quot;IT&quot;</span>, <span class="string">&quot;Finance&quot;</span>],</span><br><span class="line">    <span class="string">&quot;Employee&quot;</span>: [<span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;Bob&quot;</span>, <span class="string">&quot;Charlie&quot;</span>, <span class="string">&quot;David&quot;</span>, <span class="string">&quot;Eve&quot;</span>, <span class="string">&quot;Frank&quot;</span>],</span><br><span class="line">    <span class="string">&quot;Gender&quot;</span>: [<span class="string">&quot;Female&quot;</span>, <span class="string">&quot;Male&quot;</span>, <span class="string">&quot;Male&quot;</span>, <span class="string">&quot;Male&quot;</span>, <span class="string">&quot;Female&quot;</span>, <span class="string">&quot;Male&quot;</span>],</span><br><span class="line">    <span class="string">&quot;Salary&quot;</span>: [<span class="number">50000</span>, <span class="number">60000</span>, <span class="number">55000</span>, <span class="number">70000</span>, <span class="number">75000</span>, <span class="number">65000</span>],</span><br><span class="line">    <span class="string">&quot;Bonus&quot;</span>: [<span class="number">5000</span>, <span class="number">6000</span>, <span class="number">5500</span>, <span class="number">7000</span>, <span class="number">7500</span>, <span class="number">6500</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;每个部门的平均工资&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.pivot_table(df, values=<span class="string">&quot;Salary&quot;</span>, index=<span class="string">&quot;Department&quot;</span>, aggfunc=<span class="string">&#x27;mean&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n每个部门下每个性别的平均工资和津贴&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.pivot_table(df, values=[<span class="string">&quot;Salary&quot;</span>, <span class="string">&quot;Bonus&quot;</span>], </span><br><span class="line">                     index=<span class="string">&quot;Department&quot;</span>, columns=<span class="string">&quot;Gender&quot;</span>, </span><br><span class="line">                     aggfunc=<span class="string">&quot;mean&quot;</span>, fill_value=<span class="number">0</span>, </span><br><span class="line">                     margins=<span class="literal">True</span>, margins_name=<span class="string">&quot;Overall&quot;</span>))</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605272.png" alt=""></p><h3 id="8-5-交叉">8.5 交叉</h3><p>交叉表和透视表的参数几乎一样，但是交叉表需要指明行标签和列标签，侧重于计数统计，比如计算某两类变量各自组合的出现次数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;Category&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Region&#x27;</span>: [<span class="string">&#x27;North&#x27;</span>, <span class="string">&#x27;South&#x27;</span>, <span class="string">&#x27;North&#x27;</span>, <span class="string">&#x27;South&#x27;</span>, <span class="string">&#x27;West&#x27;</span>, <span class="string">&#x27;East&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(pd.crosstab(df[<span class="string">&#x27;Category&#x27;</span>], df[<span class="string">&#x27;Region&#x27;</span>]))</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605273.png" alt=""></p><h2 id="9-时间序列分析">9. 时间序列分析</h2><p>pandas 的时间数据对象类型为 <code>datetime64[ns]</code>，用于存储时间序列</p><h3 id="9-1-时间频率">9.1 时间频率</h3><p>锚点：是时间周期对齐的“参考点”，对于不同的频率会自动对齐到下一个锚点</p><table><thead><tr><th>频率代码</th><th>含义</th><th>默认锚点</th></tr></thead><tbody><tr><td>B</td><td>工作日</td><td>周一到周五</td></tr><tr><td>D</td><td>日历日</td><td>每天</td></tr><tr><td>W</td><td>周</td><td>周日</td></tr><tr><td>W-MON~W-SUN</td><td>星期</td><td>对应星期</td></tr><tr><td>M</td><td>月末</td><td>每月最后一天</td></tr><tr><td>MS</td><td>月初</td><td>每月第一天</td></tr><tr><td>BM</td><td>商业月末</td><td>每月最后一个工作日</td></tr><tr><td>BMS</td><td>商业月初</td><td>每月第一个工作日</td></tr><tr><td>Q</td><td>季度末</td><td>每年3/6/9/12月最后一天</td></tr><tr><td>QS</td><td>季度初</td><td>每年1/4/7/10月第一天</td></tr><tr><td>BQ</td><td>商业季度末</td><td>季度最后一个工作日</td></tr><tr><td>BQS</td><td>商业季度初</td><td>季度第一个工作日</td></tr><tr><td>Y</td><td>年末</td><td>每年12月31日</td></tr><tr><td>YS</td><td>年初</td><td>每年1月1日</td></tr><tr><td>BA</td><td>商业年末</td><td>每年最后一个工作日</td></tr><tr><td>BAS</td><td>商业年初</td><td>每年第一个工作日</td></tr><tr><td>H</td><td>小时</td><td>每小时整点</td></tr><tr><td>T</td><td>分钟</td><td>每分钟整点</td></tr><tr><td>S</td><td>秒</td><td>每秒钟整点</td></tr><tr><td>L</td><td>毫秒</td><td>每毫秒</td></tr></tbody></table><h3 id="9-2-生成时间序列">9.2 生成时间序列</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.date_range(start, end=<span class="literal">None</span>, periods=<span class="literal">None</span>, freq=<span class="string">&#x27;D&#x27;</span>, name=<span class="literal">None</span>, inclusive=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>功能</th></tr></thead><tbody><tr><td>start</td><td>起始时间，字符串或 datetime 对象</td></tr><tr><td>end</td><td>结束时间，字符串或 datetime 对象</td></tr><tr><td>periods</td><td>要生成的时间点数量</td></tr><tr><td>freq</td><td>生成频率</td></tr><tr><td>name</td><td>返回的索引的名字</td></tr><tr><td>inclusive</td><td>是否包含起始和结束时间，可以是 ‘both’, ‘neither’, ‘left’, ‘right’</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(pd.date_range(start=<span class="string">&#x27;2024-01-01&#x27;</span>, periods=<span class="number">7</span>, freq=<span class="string">&#x27;D&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(pd.date_range(start=<span class="string">&#x27;2024-01-01&#x27;</span>, periods=<span class="number">7</span>, freq=<span class="string">&#x27;W-SUN&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(pd.date_range(start=<span class="string">&#x27;2024-01-01&#x27;</span>, periods=<span class="number">7</span>, freq=<span class="string">&#x27;Q&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(pd.date_range(start=<span class="string">&#x27;2024-01-01&#x27;</span>, periods=<span class="number">7</span>, freq=<span class="string">&#x27;BM&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(pd.date_range(start=<span class="string">&#x27;2024-01-01&#x27;</span>, periods=<span class="number">7</span>, freq=<span class="string">&#x27;Y&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(pd.date_range(start=<span class="string">&#x27;2024-01-01&#x27;</span>, periods=<span class="number">7</span>, freq=<span class="string">&#x27;T&#x27;</span>))</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605274.png" alt=""></p><h3 id="9-2-转换时间序列对象">9.2 转换时间序列对象</h3><p>读取并利用数据文件中的日期，分为以下三步：</p><ol><li>将字符串类型转换为日期时间类型</li><li>将日期列设置为索引，从而变成一个时间序列对象</li><li>通过 dt 访问器来提取日期的各个部分</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&quot;date_str&quot;</span>: [<span class="string">&quot;2024-02-27&quot;</span>, <span class="string">&quot;2024-03-27&quot;</span>, <span class="string">&quot;2024-04-27&quot;</span>, <span class="string">&quot;2024-05-27&quot;</span>],</span><br><span class="line">    <span class="string">&quot;income&quot;</span>: [<span class="number">10000</span>, <span class="number">8000</span>, <span class="number">9500</span>, <span class="number">8880</span>]</span><br><span class="line">&#125;)</span><br><span class="line">df[<span class="string">&#x27;date&#x27;</span>] = pd.to_datetime(df[<span class="string">&#x27;date_str&#x27;</span>])</span><br><span class="line">df = df.set_index(<span class="string">&#x27;date&#x27;</span>)</span><br><span class="line">df.drop(axis=<span class="number">1</span>, labels=<span class="string">&#x27;date_str&#x27;</span>, inplace=<span class="literal">True</span>)</span><br><span class="line">df[<span class="string">&#x27;year&#x27;</span>] = df.index.year</span><br><span class="line">df[<span class="string">&#x27;month&#x27;</span>] = df.index.month</span><br><span class="line">df[<span class="string">&#x27;day&#x27;</span>] = df.index.day</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605275.png" alt=""></p><h3 id="9-3-修改频率">9.3 修改频率</h3><p>原始数据的频率可能是每天，每周的，因此当我们需要对其他频率的时间进行分析时，就需要修改频率，主要有以下两个方法</p><ul><li><code>asfreq(freq)</code>：直接改变时间序列的频率而不进行聚合</li><li><code>resample(rule)</code>：根据指定的时间频率将时间序列数据进行重采样，并配合聚合函数实现数据的降采样或上采样，最后得到聚合结果组成的时间序列对象</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">df_index = pd.date_range(start=<span class="string">&#x27;2024-02-27&#x27;</span>, periods=<span class="number">50</span>, freq=<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;salary&#x27;</span>: np.random.randint(<span class="number">8000</span>, <span class="number">10000</span>, <span class="number">50</span>),</span><br><span class="line">    <span class="string">&#x27;bonus&#x27;</span>: np.random.randint(<span class="number">50</span>, <span class="number">200</span>, <span class="number">50</span>)</span><br><span class="line">&#125;, index=df_index)</span><br><span class="line"><span class="built_in">print</span>(df.resample(rule=<span class="string">&#x27;W&#x27;</span>).mean())</span><br><span class="line"><span class="built_in">print</span>(df.asfreq(freq=<span class="string">&#x27;M&#x27;</span>))</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605276.png" alt="">### 9.4 时序偏移</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.shift(periods=<span class="number">1</span>, freq=<span class="literal">None</span>, axis=<span class="number">0</span>, fill_value=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>功能</th></tr></thead><tbody><tr><td>periods</td><td>根据给定的整数移动数据</td></tr><tr><td>freq</td><td>根据给定的时间频率移动索引</td></tr><tr><td>axis</td><td>0 表示遍历列，1 表示遍历行</td></tr><tr><td>fill_value</td><td>指定缺失位置填充的值</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">df_index = pd.date_range(start=<span class="string">&#x27;2024-02-27&#x27;</span>, periods=<span class="number">50</span>, freq=<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;salary&#x27;</span>: np.random.randint(<span class="number">8000</span>, <span class="number">10000</span>, <span class="number">50</span>),</span><br><span class="line">    <span class="string">&#x27;bonus&#x27;</span>: np.random.randint(<span class="number">50</span>, <span class="number">200</span>, <span class="number">50</span>)</span><br><span class="line">&#125;, index=df_index)</span><br><span class="line">df_sample = df.resample(rule=<span class="string">&#x27;W&#x27;</span>).mean()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n最初&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df_sample)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n移动索引&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df_sample.shift(freq=<span class="string">&#x27;W&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n移动数据&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(df_sample.shift(periods=<span class="number">1</span>))</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605277.png" alt=""></p><h3 id="9-5-时间窗口">9.5 时间窗口</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.rolling(window=<span class="literal">None</span>, min_periods=<span class="literal">None</span>, step=<span class="literal">None</span>, center=<span class="literal">False</span>, on=<span class="literal">None</span>, axis=<span class="number">0</span>, closed=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>功能</th></tr></thead><tbody><tr><td>window</td><td>整数表示按行滑动，字符串表示按时间跨度滑动</td></tr><tr><td>min_periods</td><td>窗口内最小有效值数量，否则为 NaN</td></tr><tr><td>step</td><td>窗口移动的步长，只适用于整数滑动</td></tr><tr><td>center</td><td>是否以当前行为中心滚动窗口</td></tr><tr><td>on</td><td>指定哪一列作为时间索引，默认本身的索引</td></tr><tr><td>closed</td><td>时间窗口边界是否闭合</td></tr><tr><td>axis</td><td>0 表示遍历列，1 表示遍历行</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df_index = pd.date_range(start=<span class="string">&#x27;2024-02-27&#x27;</span>, periods=<span class="number">5</span>, freq=<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;salary&#x27;</span>: [<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>, <span class="number">400</span>, <span class="number">600</span>]</span><br><span class="line">&#125;, index=df_index)</span><br><span class="line"><span class="built_in">print</span>(df.rolling(<span class="string">&#x27;3D&#x27;</span>).<span class="built_in">sum</span>())</span><br><span class="line"><span class="built_in">print</span>(df.rolling(<span class="string">&#x27;3D&#x27;</span>,center=<span class="literal">True</span>).<span class="built_in">sum</span>())</span><br><span class="line"><span class="built_in">print</span>(df.rolling(<span class="number">3</span>).<span class="built_in">sum</span>())</span><br><span class="line"><span class="built_in">print</span>(df.rolling(<span class="string">&#x27;3D&#x27;</span>,min_periods=<span class="number">1</span>).<span class="built_in">sum</span>())</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://dasi-blog.oss-cn-guangzhou.aliyuncs.com/DataAnalysis/Pandas/202504061605278.png" alt=""></p><blockquote><p>窗口默认是右对齐的，即当前索引作为窗口末尾，除非使用 center 参数，无法实现左对齐</p></blockquote><h3 id="9-6-可视化">9.6 可视化</h3><h2 id="10-性能优化">10. 性能优化</h2><ol><li><strong>使用较小的数据类型</strong>：使用 <code>astype()</code> 转化为指定的 int16 和 float32，或者直接利用某些方法的 <code>downcast</code> 参数让系统尝试下转</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>, <span class="number">400</span>], <span class="string">&#x27;B&#x27;</span>: [<span class="number">1000</span>, <span class="number">2000</span>, <span class="number">3000</span>, <span class="number">4000</span>]&#125;)</span><br><span class="line">df[<span class="string">&#x27;A&#x27;</span>] = df[<span class="string">&#x27;A&#x27;</span>].astype(<span class="string">&#x27;int16&#x27;</span>)</span><br><span class="line">df[<span class="string">&#x27;B&#x27;</span>] = df[<span class="string">&#x27;B&#x27;</span>].astype(<span class="string">&#x27;int32&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li><strong>使用 category 类型代替用作类别的字符串</strong>：系统会自动维护一个去重的类别字符串列表，category 类型在内存中存储的是整数索引，而不是字符串本身</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;Letter&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>]&#125;)</span><br><span class="line">df[<span class="string">&#x27;Letter&#x27;</span>] = df[<span class="string">&#x27;Letter&#x27;</span>].astype(<span class="string">&#x27;category&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="3"><li><strong>使用向量化操作而非循环</strong>：循环是基于 Python，而向量化操作是利用 Pandas 库底层的优化进行快速计算</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="string">&#x27;B&#x27;</span>: [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]&#125;)</span><br><span class="line">df[<span class="string">&#x27;C&#x27;</span>] = df[<span class="string">&#x27;A&#x27;</span>] + df[<span class="string">&#x27;B&#x27;</span>]</span><br></pre></td></tr></table></figure><ol start="4"><li><strong>使用映射而非循环</strong>：<code>apply()</code> 和 <code>applymap()</code> 可以在数据框架中按行或按列应用函数，能够比循环更高效</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="string">&#x27;B&#x27;</span>: [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]&#125;)</span><br><span class="line">df[<span class="string">&#x27;D&#x27;</span>] = df[<span class="string">&#x27;A&#x27;</span>].apply(<span class="keyword">lambda</span> x: x ** <span class="number">2</span>)</span><br><span class="line">df = df.applymap(<span class="keyword">lambda</span> x: x * <span class="number">10</span>)</span><br></pre></td></tr></table></figure><ol start="5"><li><strong>指明合并条件，避免笛卡尔积</strong>：在处理大数据集时，可以使用 on 和 how 参数明确指定合并方式，避免不必要的计算</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(&#123;<span class="string">&#x27;ID&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="string">&#x27;Value&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>]&#125;)</span><br><span class="line">df2 = pd.DataFrame(&#123;<span class="string">&#x27;ID&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="string">&#x27;Value&#x27;</span>: [<span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>]&#125;)</span><br><span class="line">merged_df = pd.merge(df1, df2, on=<span class="string">&#x27;ID&#x27;</span>, how=<span class="string">&#x27;inner&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="6"><li><strong>使用分块加载大数据集</strong>：Pandas 读取各类文件的函数都提供了 chunksize 参数，允许加载整个数据集时分块加载并处理，防止内存溢出</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> chunk <span class="keyword">in</span> pd.read_csv(<span class="string">&#x27;large_file.csv&#x27;</span>, chunksize=<span class="number">100000</span>):</span><br><span class="line">    process(chunk)</span><br></pre></td></tr></table></figure><ol start="7"><li><strong>避免链式赋值</strong>：指的是在 Pandas 中对 DataFrame 或 Series 进行多次索引操作时，直接对中间结果进行赋值的一种操作方式</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 链式赋值</span></span><br><span class="line">df[df[<span class="string">&#x27;A&#x27;</span>] &gt; <span class="number">2</span>][<span class="string">&#x27;A&#x27;</span>] = <span class="number">0</span></span><br><span class="line"><span class="comment"># 正确赋值</span></span><br><span class="line">df.loc[df[<span class="string">&#x27;A&#x27;</span>] &gt; <span class="number">2</span>, <span class="string">&#x27;A&#x27;</span>] = <span class="number">0</span></span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>Pandas</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://dasi.plus/posts/38d36e05/">https://dasi.plus/posts/38d36e05/</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a" style="display:inline-block;width:55px"><h>作者</h><div class="post-copyright-cc-info"><h>Dasi</h></div></div><div class="post-copyright-c" style="display:inline-block;width:105px"><h>发布于</h><div class="post-copyright-cc-info"><h>2025-04-06</h></div></div><div class="post-copyright-u" style="display:inline-block;width:105px"><h>更新于</h><div class="post-copyright-cc-info"><h>2025-06-23</h></div></div><div class="post-copyright-c" style="display:inline-block;width:98px"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY 4.0" href="https://creativecommons.org/licenses/by/4.0/deed.zh">CC BY 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Data-Analysis/">Data Analysis</a><a class="post-meta__tags" href="/tags/Python/">Python</a></div><div class="post_share"><div class="social-share" data-image="/image/analysis.png" data-sites="twitter,wechat,qq"></div><link rel="stylesheet" href="/pluginsSrc/butterfly-extsrc/sharejs/dist/css/share.min.css?v=1.1.3" media="print" onload='this.media="all"'><script src="/pluginsSrc/butterfly-extsrc/sharejs/dist/js/social-share.min.js?v=1.1.3" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/50dce9b/" title="语义分析"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/compile.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">语义分析</div><div class="content">语义分析概述、属性文法、语义分析策略（SDD、SDT）、LR翻译S-属性文法、LL翻译L-属性文法</div></div></a></div><div class="next-post pull-right"><a href="/posts/d1e3c468/" title="Matplotlib"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/analysis.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Matplotlib</div><div class="content">线图 plot、子图 subplot、饼图 pie、散点图 scatter、柱状图 bar、直方图 hist、图片处理 im</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/d1e3c468/" title="Matplotlib"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/analysis.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-01</div><div class="title">Matplotlib</div><div class="info">线图 plot、子图 subplot、饼图 pie、散点图 scatter、柱状图 bar、直方图 hist、图片处理 im</div></div></a></div><div><a href="/posts/3be9a986/" title="Numpy"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/analysis.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-01</div><div class="title">Numpy</div><div class="info">数组属性、数据类型、创建/切片/索引/广播/迭代/变形/连接/分割/翻转/添加/删除操作、字符串/数学/统计学/线性代数/条件筛选运算、随机模块</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0-%E5%89%8D%E8%A8%80"><span class="toc-text">0. 前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Pandas-%E7%AE%80%E4%BB%8B"><span class="toc-text">1. Pandas 简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Series"><span class="toc-text">2. Series</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%88%9B%E5%BB%BA"><span class="toc-text">2.1 创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%B1%9E%E6%80%A7"><span class="toc-text">2.2 属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%9C%89%E5%85%B3%E7%B4%A2%E5%BC%95%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-text">2.3 有关索引的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%9C%89%E5%85%B3%E5%85%83%E7%B4%A0%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-text">2.3 有关元素的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E6%9C%89%E5%85%B3-NaN-%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-text">2.4 有关 NaN 的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E6%9C%89%E5%85%B3%E7%BB%9F%E8%AE%A1%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-text">2.5 有关统计的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-%E5%B8%83%E5%B0%94%E7%B4%A2%E5%BC%95-%E6%9D%A1%E4%BB%B6%E8%BF%87%E6%BB%A4"><span class="toc-text">2.6 布尔索引&#x2F;条件过滤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-DataFrame"><span class="toc-text">3. DataFrame</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%88%9B%E5%BB%BA"><span class="toc-text">3.1 创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%B1%9E%E6%80%A7"><span class="toc-text">3.2 属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%A2%9E%E5%88%A0%E6%9F%A5%E6%94%B9"><span class="toc-text">3.3 增删查改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E9%87%8D%E5%A1%91"><span class="toc-text">3.4 重塑</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-CSV"><span class="toc-text">4. CSV</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-read-csv"><span class="toc-text">4.1 read_csv</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-to-csv"><span class="toc-text">4.2 to_csv</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-JSON"><span class="toc-text">5. JSON</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-JSON-%E7%AE%80%E4%BB%8B"><span class="toc-text">5.1 JSON 简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-read-json"><span class="toc-text">5.2 read_json</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-to-json"><span class="toc-text">5.3 to_json</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97"><span class="toc-text">6. 数据清洗</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E7%BC%BA%E5%A4%B1%E5%80%BC%E5%A4%84%E7%90%86"><span class="toc-text">6.1 缺失值处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E9%87%8D%E5%A4%8D%E5%80%BC%E5%A4%84%E7%90%86"><span class="toc-text">6.2 重复值处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E5%BC%82%E5%B8%B8%E5%80%BC%E5%A4%84%E7%90%86"><span class="toc-text">6.3 异常值处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-%E6%9B%BF%E6%8D%A2%E5%80%BC%E5%A4%84%E7%90%86"><span class="toc-text">6.4 替换值处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-text">7. 数据预处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%8D%A2"><span class="toc-text">7.1 格式转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E6%95%B0%E5%80%BC%E5%A4%84%E7%90%86"><span class="toc-text">7.2 数值处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E7%B1%BB%E5%88%AB%E5%A4%84%E7%90%86"><span class="toc-text">7.3 类别处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-%E6%95%B0%E6%8D%AE%E6%8A%BD%E6%A0%B7"><span class="toc-text">7.4 数据抽样</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E6%95%B0%E5%80%BC%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90"><span class="toc-text">8. 数值数据分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E6%8E%92%E5%BA%8F"><span class="toc-text">8.1 排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E8%81%9A%E5%90%88"><span class="toc-text">8.2 聚合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%93%8D%E4%BD%9C"><span class="toc-text">8.3 自定义操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-%E9%80%8F%E8%A7%86"><span class="toc-text">8.4 透视</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-5-%E4%BA%A4%E5%8F%89"><span class="toc-text">8.5 交叉</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%88%86%E6%9E%90"><span class="toc-text">9. 时间序列分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E6%97%B6%E9%97%B4%E9%A2%91%E7%8E%87"><span class="toc-text">9.1 时间频率</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-%E7%94%9F%E6%88%90%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97"><span class="toc-text">9.2 生成时间序列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-%E8%BD%AC%E6%8D%A2%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%AF%B9%E8%B1%A1"><span class="toc-text">9.2 转换时间序列对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-%E4%BF%AE%E6%94%B9%E9%A2%91%E7%8E%87"><span class="toc-text">9.3 修改频率</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-5-%E6%97%B6%E9%97%B4%E7%AA%97%E5%8F%A3"><span class="toc-text">9.5 时间窗口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-6-%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-text">9.6 可视化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-text">10. 性能优化</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By Dasi</div><div class="footer_custom_text"><p><a style="margin-inline:5px" target="_blank" href="https://hexo.io/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为 Hexo" alt="HEXO"></a><a style="margin-inline:5px" target="_blank" href="https://butterfly.js.org/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用 Butterfly" alt="Butterfly"></a><a style="margin-inline:5px" target="_blank" href="https://github.com/"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由 GitHub 托管" alt="GitHub"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"></div><div id="rightside-config-show"><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button class="share" type="button" title="分享链接" onclick="share()"><i class="fas fa-share-nodes"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa-solid fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa-solid fa-arrow-rotate-right"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa-solid fa-arrow-right"></i></a><a class="rightMenu-item" id="menu-radompage" href="javascript:window.location.href = window.location.origin;"><i class="fa-solid fa-house"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa-solid fa-copy"></i><span>复制</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:rmf.switchDarkMode();"><i class="fa-solid fa-circle-half-stroke"></i><span>昼夜切换</span></a><a class="rightMenu-item" href="javascript:rmf.switchReadMode();"><i class="fa-solid fa-book"></i><span>阅读模式</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa-solid fa-arrow-up"></i><span>置顶</span></a><a class="rightMenu-item" href="javascript:rmf.copyPageUrl();"><i class="fa-solid fa-link"></i><span>复制链接</span></a></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/pluginsSrc/@fancyapps/ui/dist/fancybox/fancybox.umd.js?v=5.0.33"></script><script src="/pluginsSrc/instant.page/instantpage.js?v=5.2.0" type="module"></script><script src="/pluginsSrc/vanilla-lazyload/dist/lazyload.iife.min.js?v=17.8.8"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("/pluginsSrc/pangu/dist/browser/pangu.min.js?v=4.0.7").then((()=>{pangu.autoSpacingPage()}))}function panguInit(){GLOBAL_CONFIG_SITE.isPost&&panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><div class="js-pjax"><link rel="stylesheet" href="/pluginsSrc/katex/dist/katex.min.css?v=0.16.9"><script src="/pluginsSrc/katex/dist/contrib/copy-tex.min.js?v=0.16.9"></script><script>document.querySelectorAll("#article-container span.katex-display").forEach((a=>{btf.wrap(a,"div",{class:"katex-wrap"})}))</script></div><script src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script><script src="/js/rightmenu.js?1"></script><script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script><script src="/js/rightside.js?1"></script><script src="/js/sitetitle.js?1"></script><script id="click-show-text" src="/pluginsSrc/butterfly-extsrc/dist/click-show-text.min.js?v=1.1.3" data-mobile="false" data-text="d,a,s,i" data-fontsize="20px" data-random="false" async></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div><script data-pjax>function butterfly_swiper_injector_config(){var s=document.getElementById("recent-posts");console.log("已挂载butterfly_swiper"),s.insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/7bb01bb2/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/algorithm.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-10-22</span><a class="blog-slider__title" href="posts/7bb01bb2/" alt="">动态规划</a><div class="blog-slider__text">介绍了动态规划的原理，并用4个典例进行了详细分析，总结过后完成经典DP问题</div><a class="blog-slider__button" href="posts/7bb01bb2/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/46ae7d29/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/ai.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-04-28</span><a class="blog-slider__title" href="posts/46ae7d29/" alt="">α-β剪枝</a><div class="blog-slider__text">博弈、极大极小分析法、剪枝原理分析、剪枝算法分析、通用代码、效率分析、井字棋案例</div><a class="blog-slider__button" href="posts/46ae7d29/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/f11dbe61/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/git.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-09-13</span><a class="blog-slider__title" href="posts/f11dbe61/" alt="">Git基本操作</a><div class="blog-slider__text">介绍git的基本操作以及对git指令的理解</div><a class="blog-slider__button" href="posts/f11dbe61/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/55180fbf/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/compile.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-04</span><a class="blog-slider__title" href="posts/55180fbf/" alt="">词法分析</a><div class="blog-slider__text">词法分析程序、形式化描述工具（正规文法、正规式、有穷自动机）、转换流程、lex</div><a class="blog-slider__button" href="posts/55180fbf/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/55f40959/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/ai.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-03-21</span><a class="blog-slider__title" href="posts/55f40959/" alt="">谓词逻辑的归结反演</a><div class="blog-slider__text">如何利用python实现谓词逻辑的归结反演，详细分析了每个函数</div><a class="blog-slider__button" href="posts/55f40959/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="posts/bbea855c/" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/network.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-08-22</span><a class="blog-slider__title" href="posts/bbea855c/" alt="">运输层</a><div class="blog-slider__text">多路复用、多路分解、UDP和TCP、可靠数据传输原理、流水线模式和拥塞控制算法</div><a class="blog-slider__button" href="posts/bbea855c/" alt="">详情   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>')}for(var elist="undefined".split(","),cpage=location.pathname,epage="/",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_swiper_injector_config()</script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script></body></html>